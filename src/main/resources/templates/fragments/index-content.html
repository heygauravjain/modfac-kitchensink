<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8"/>
  <title>Member Registration</title>
</head>
<body>
<div th:fragment="content">
  <h1>Welcome to Member Registration!</h1>

  <!-- Success Message -->
  <div th:if="${registrationSuccess}">
    <div th:text="${successMessage}" class="valid"></div>
  </div>

  <!-- Error Message -->
  <div th:if="${registrationError}">
    <div th:text="${errorMessage}" class="invalid"></div>
  </div>

  <!-- Registration Form -->
  <form th:action="@{/register}" th:object="${member}" method="post">
    <fieldset>
      <legend>Member Registration</legend>

      <!-- Name Field with Client-Side Validation -->
      <div>
        <label for="name">Name:</label>
        <div class="tooltip">
          <input type="text" id="name" th:field="*{name}" placeholder="Enter your name" required
                 minlength="3" maxlength="25"/>
          <span class="tooltiptext">Enter your name. Must not contain any numbers.</span>
        </div>
      </div>

      <!-- Email Field with Client-Side Validation -->
      <div>
        <label for="email">Email:</label>
        <div class="tooltip">
          <input type="email" id="email" th:field="*{email}" required/>
          <span class="tooltiptext">Enter a valid email address (e.g., user@example.com).</span>
        </div>
      </div>

      <!-- Phone Number Field with Client-Side Validation -->
      <div>
        <label for="phoneNumber">Phone #:</label>
        <div class="tooltip">
          <input type="text" id="phoneNumber" th:field="*{phoneNumber}" required pattern="\d{10,12}"/>
          <span class="tooltiptext">Enter a valid phone number (10 to 12 digits).</span>
        </div>
      </div>

      <!-- Role Selection Radio Buttons -->
      <div>
        <label>Role:</label>
        <div class="tooltip">
          <input type="radio" id="roleAdmin" name="role" th:field="*{role}" value="ADMIN"/>
          <label for="roleAdmin">ADMIN</label>

          <input type="radio" id="roleUser" name="role" th:field="*{role}" value="USER"/>
          <label for="roleUser">USER</label>
          <span class="tooltiptext">Select the role for the user.</span>
        </div>
      </div>

      <!-- Submit Button -->
      <div>
        <button type="submit" class="register">Register</button>
      </div>
    </fieldset>
  </form>

  <!-- Members List -->
  <h2>Members</h2>
  <div th:if="${#lists.isEmpty(members)}">
    <em>No registered Members.</em>
  </div>
  <div th:if="${!#lists.isEmpty(members)}">
    <table class="simpletablestyle">
      <thead>
      <tr>
        <th>Id</th>
        <th>Name</th>
        <th>Email</th>
        <th>Phone #</th>
        <th>Role</th>
        <th>REST URL</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="member : ${members}">
        <td th:text="${member.id}"></td>
        <td th:text="${member.name}"></td>
        <td th:text="${member.email}"></td>
        <td th:text="${member.phoneNumber}"></td>
        <td th:text="${member.role}"></td>
        <td>
          <!-- Updated link to open in a pop-up frame -->
          <a th:href="@{/rest/members/{id}(id=${member.id})}" onclick="return loadInFrame(this.href)">/rest/members/<span th:text="${member.id}"></span></a>
        </td>
      </tr>
      </tbody>
    </table>
    <div>
      Rest url for all members: <a href="/rest/members" onclick="return loadInFrame(this.href)">/rest/members</a>
    </div>
  </div>
</div>
</body>
</html>
